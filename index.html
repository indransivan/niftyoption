<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NIFTY Options</title>

<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<style>
body { margin:0; background:#0a0a0a; color:white; font-family:sans-serif }
.chart { height:300px; margin:10px }
</style>
</head>

<body>

<h3>ðŸ“ˆ CALL <span id="callStrike"></span></h3>
<div id="call" class="chart"></div>

<h3>ðŸ“‰ PUT <span id="putStrike"></span></h3>
<div id="put" class="chart"></div>

<div style="text-align:center;opacity:.6">
Last update: <span id="time"></span>
</div>

<script>
const ws = new WebSocket(
  (location.protocol === "https:" ? "wss://" : "ws://") +
  location.host + "/ws"
);

const options = {
  layout: { background:{color:"#0a0a0a"}, textColor:"#fff" },
  grid: { vertLines:{color:"#222"}, horzLines:{color:"#222"} },
  timeScale: { timeVisible:true }
};

const callChart = LightweightCharts.createChart(document.getElementById("call"), options);
const putChart  = LightweightCharts.createChart(document.getElementById("put"), options);

const callSeries = callChart.addCandlestickSeries();
const putSeries  = putChart.addCandlestickSeries();

ws.onmessage = e => {
  const d = JSON.parse(e.data);

  callSeries.setData(d.call.candles);
  putSeries.setData(d.put.candles);

  document.getElementById("callStrike").innerText = d.call.strike;
  document.getElementById("putStrike").innerText  = d.put.strike;
  document.getElementById("time").innerText = d.timestamp;
};
</script>

</body>
</html>
